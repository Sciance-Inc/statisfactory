:py:mod:`statisfactory`
=======================

.. py:module:: statisfactory


Subpackages
-----------
.. toctree::
   :titlesonly:
   :maxdepth: 3

   IO/index.rst
   cli/index.rst
   internals/index.rst
   loader/index.rst
   models/index.rst
   operator/index.rst
   session/index.rst


Submodules
----------
.. toctree::
   :titlesonly:
   :maxdepth: 1

   __main__/index.rst
   __version__/index.rst
   errors/index.rst
   logger/index.rst


Package Contents
----------------

Classes
~~~~~~~

.. autoapisummary::

   statisfactory.Catalog
   statisfactory.Artifact
   statisfactory.Volatile
   statisfactory.Pipeline
   statisfactory._Craft
   statisfactory.Session



Functions
~~~~~~~~~

.. autoapisummary::

   statisfactory.Craft



Attributes
~~~~~~~~~~

.. autoapisummary::

   statisfactory.__version__


.. py:class:: Catalog(*, path: pathlib.Path, session: statisfactory.session.BaseSession = None)

   Bases: :py:obj:`statisfactory.logger.MixinLogable`

   Catalog represent a loadable / savable set of dataframes living locally or in far, far aways distributed system.

   .. py:method:: artifacts(self)
      :property:


   .. py:method:: __str__(self)

      Show all artifacts entries


   .. py:method:: __contains__(self, name: str) -> bool

      Check if the given name is an artifact


   .. py:method:: _get_artifact(self, name: str) -> statisfactory.models.models.Artifact

      Retrieve the FIRST artifact matching the given name currently living in the catalog.


   .. py:method:: _get_interactor(self, artifact: statisfactory.models.models.Artifact) -> Callable

      Retrieve the interactor matchin the type of the artifact.


   .. py:method:: load(self, name: str, **context) -> pandas.DataFrame

      Load an asset from the catalogue.
      A context can be provided through named variadic args.
      if a context is provided, the update of the context won't raised any error

      Args:
          name (str): the name of the artifact to load.


   .. py:method:: save(self, name: str, asset: Any, **context)

      Save the asset using the artifact name.
      A context can be provided through named variadic args.
      if a context is provided, the update of the context won't raised any error

      Args:
          name (str): the name of the arteface
          asset (Any): the underlying artifact to store


   .. py:method:: __add__(self, other: Any)

      Implements the visitor pattern for the catalog

      Args:
          other (Any): The right object to add


   .. py:method:: visit_catalog(self, other: Catalog) -> Catalog

      Implements the visitor pattern for the catalog. Combining two catalogs results in a merged catalog.

      Args:
          other (Catalog): The other catalogi to combine with

      Raise:
          Errors.E033: if two artifacts keys collide.



.. py:class:: Artifact

   Represents an Artifact : the I/O of a statisfactory node.

   .. py:attribute:: name
      :annotation: :str

      

   .. py:attribute:: extra
      :annotation: :Optional[Dict[str, Any]]

      

   .. py:attribute:: save_options
      :annotation: :Optional[Dict[str, Any]]

      

   .. py:attribute:: load_options
      :annotation: :Optional[Dict[str, Any]]

      

   .. py:attribute:: type
      :annotation: :str = 

      

   .. py:method:: of(*args) -> List[Artifact]
      :staticmethod:

      Convenient helper to return a tuple of Artifact from an iterable of strings.



.. py:class:: Volatile

   Represents data outputed by the Craft but not to be persisted in the catalog

   .. py:attribute:: name
      :annotation: :str

      

   .. py:method:: of(*args) -> List[Volatile]
      :staticmethod:

      Convenient helper to return a tuple of volatile from an iterable of strings.



.. py:function:: Craft()

   Make a new _Craft


.. py:class:: Pipeline(*, name: str = 'noName', tags: Optional[List[str]] = None)

   Bases: :py:obj:`statisfactory.operator.scoped.Scoped`, :py:obj:`statisfactory.operator.mixinHookable.MixinHookable`, :py:obj:`statisfactory.operator.utils.MergeableInterface`, :py:obj:`statisfactory.logger.MixinLogable`

   Implements a way to combine crafts and pipeline togetger

   .. py:method:: tags(self) -> Optional[List[str]]
      :property:

      Returns the tags of the pipeline.


   .. py:method:: name(self)
      :property:

      Pipeline's name getter.


   .. py:method:: crafts(self) -> List[statisfactory.operator.craft._Craft]
      :property:

      Crafts getter


   .. py:method:: plot(self)

      Display the graph.


   .. py:method:: __add__(self, visitor: statisfactory.operator.utils.MergeableInterface) -> Pipeline

      Add a Mergeable to the pipeline.
      Implements the accept part of the visitor pattern.


   .. py:method:: visit_craft(self, craft) -> Pipeline

      Insert the given craft in the first position of the pipeline.


   .. py:method:: visit_pipeline(self, pipeline: Pipeline)

      Update self by adding the crafts from 'pipeline'.

      Args:
          pipeline (Pipeline): the pipeline to update and return


   .. py:method:: __str__(self)

      Implements the print method to display the pipeline


   .. py:method:: __call__(self, **shared) -> Dict[str, Any]

      Concretely run a Pipeline with two Mapping of parameters.

      Args:
          kwargs (Optional[Dict[str, any]]): An optionnal mapping containings configuration to be shared and namespaced configuration to be dispatched to the craft.The __call__ method uses the FQN of a craft to accordingly dispatch the configurations.

      Returns:
          Dict[str, Any]: the final transient state resultuing from the craft application



.. py:class:: _Craft(callable: Callable)

   Bases: :py:obj:`statisfactory.operator.scoped.Scoped`, :py:obj:`statisfactory.operator.mixinHookable.MixinHookable`, :py:obj:`statisfactory.operator.utils.MergeableInterface`, :py:obj:`statisfactory.logger.MixinLogable`

   Craft wraps a task and take care of data retrieval from / storage to the catalogue.

   .. py:attribute:: _artifacts_annotation
      

      

   .. py:method:: _input_to_annotations(self, inputs) -> Tuple[statisfactory.operator.annotations.Annotation, Ellipsis]

      Convert a Python's callable annotation, as returned by Signature to a list of SElement


   .. py:method:: _output_to_annotation(self, inputs) -> Tuple[statisfactory.operator.annotations.Annotation, Ellipsis]

      Convert a Python's callable return value to a list of SElement.


   .. py:method:: name(self) -> str
      :property:

      Get the name of the craft


   .. py:method:: requires(self) -> Tuple[str, Ellipsis]
      :property:

      Return the name of the volatiles and artifact required by the craft


   .. py:method:: produces(self) -> Tuple[str, Ellipsis]
      :property:

      Return the names of the volatiles and artifacts produced by the Craft.


   .. py:method:: output_annotations(self) -> Tuple[statisfactory.operator.annotations.Annotation, Ellipsis]
      :property:

      Returns the full annotations of the items returned by the craft


   .. py:method:: input_annotations(self) -> Tuple[statisfactory.operator.annotations.Annotation, Ellipsis]
      :property:

      Returns the full annotations of the items ingested by the craft.


   .. py:method:: _parse_args(self, context: Mapping, volatiles_mapping: Mapping) -> Tuple[Dict[str, Any], Dict[str, Any]]

      Parse the Craft's arguments against it's signature


   .. py:method:: __call__(self, volatiles_mapping: Union[Mapping[str, Any], None] = None, **kwargs)

      Implements the call protocole for the Craft wrapper.
      Load and save the Artifact for the undelryaing callable.
      Defers the call to the underlying artifact.

      Args:
          volatiles_mapping: A mappping of volatiles objects, computed before the craft execution
          kwargs: variadic keywrods arguments to be defered to the underlaying callable.


   .. py:method:: __copy__(self) -> _Craft

      Implements the shallow copy protocol for the Craft.

      Return a craft with a reference to a copied catalog, so that the context can be independtly updated.


   .. py:method:: _save_artifacts(self, *, output, **context) -> Union[Mapping, None]

      Extract and save the artifact of an output

      Args:
          out (Dict): the dictionnary to extract artifacts from.


   .. py:method:: __add__(self, visitor: statisfactory.operator.utils.MergeableInterface)

      Combine two crafts into a pipeline.
      Implements the accept part of the visitor pattern.

      Args:
          visitor (MergeableInterface): the craft / pipeline to combine


   .. py:method:: visit_craft(self, craft: _Craft)

      Combine two crafts into a pipeline

      Args:
          craft (Craft): the other craft to add


   .. py:method:: visit_pipeline(self, pipeline: statisfactory.operator.pipeline.Pipeline)

      Add the craft in last position to the visiting pipeline



.. py:class:: Session

   Instanciate the Session object.
   The Session class used is generaly the `statisfactory.session.base_session`.

   The user can specify a custom session by specifiying the following configuration in the `pyproject.toml` file :

   ```toml
   [tool.statisfactory.session_factory]
   module = 'session.custom_session'
   factory = 'MySession'
   ```

   Where `module` is the name of a module inside the project and factory is the name of a class from that module.

   The Session is the entry point of a Statisfactory application
   The session loads the Statisfactory configuration file and executes the registered hooks.

   .. py:method:: get_active_session()
      :staticmethod:

      Get the Session, currently on the top of the stack.
      Must be called from a `with` statement



.. py:data:: __version__
   :annotation: = 0.15.2

   

