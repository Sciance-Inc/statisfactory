:py:mod:`statisfactory.session.base_session`
============================================

.. py:module:: statisfactory.session.base_session

.. autoapi-nested-parse::

   Implements a base session with default parameters.
   The session schould be implemented through the Session method the session.session module.



Module Contents
---------------

Classes
~~~~~~~

.. autoapisummary::

   statisfactory.session.base_session.BaseSession
   statisfactory.session.base_session._DefaultHooks




.. py:class:: BaseSession(*, root_folder: Optional[str] = None)

   Bases: :py:obj:`statisfactory.logger.MixinLogable`

   Base class for all Session objects.
   The Session is the entry point of a Statisfactory application

   The session loads the Statisfactory configuration file and executes the registered hooks.

   The class exposes :
       * Getter to the ``settings``, parsed during the class instanciation
       * Getters to pipelines definitions and configurations, if any.
       * A decorator : hook_post_init. To help the user registering is own extention.

   The session expose a ``_`` attributes, for the user to register his own datas.

   Implementation details:
   * The class is actually never instanciated. It serves as an abstract classe to be injected somehow in the hierarchy of the dynamically defined Session.
   * The class by itself does not do much, but delegates must of the work the the hooks.
   * The hooks can be used to develop plugins : such as an integration to mlflow, the instanciation of a Spark session.
   * The ``_`` attribute schould be used to store user defined custom extension

   .. py:attribute:: _hooks
      :annotation: = []

      

   .. py:method:: __enter__(self)

      Push the Session on top of the thread-safe stack


   .. py:method:: __exit__(self, exception_type, exception_value, exception_traceback)

      Remove the topmost Session of the thread safe stack


   .. py:method:: root(self) -> pathlib.Path
      :property:

      Getter for the Root path of the project


   .. py:method:: settings(self) -> dynaconf.Dynaconf
      :property:

      Getter for the session's base setting.


   .. py:method:: catalog(self) -> statisfactory.IO.Catalog
      :property:

      Getter for the session's catalog.


   .. py:method:: pipelines_definitions(self)
      :property:

      Getter for the session's pipelines definitions.


   .. py:method:: parameters(self)
      :property:

      Getter for the session's parameters


   .. py:method:: aws_session(self) -> boto3.Session
      :property:

      Getter for the AWS client

      Returns:
          boto3.Session: The session configured via the initiaition hook.


   .. py:method:: git(self) -> pygit2.Repository
      :property:

      Getter for the Git repository the session belongs to.


   .. py:method:: lakefs_client(self) -> lakefs_client.client.LakeFSClient
      :property:

      Getter for the AWS client
      Returns:
          The lakeFS configured via the initiaition hook.


   .. py:method:: lakefs_repo(self)
      :property:

      Return the LakeFS repository's pointer.


   .. py:method:: hook_post_init(cls, last=True) -> Callable
      :classmethod:

      Register a `callable_` to be executed after the session instanciation.



.. py:class:: _DefaultHooks

   Name spaces for the mandatory Session postinits hooks.

   Hooks will be executed int the order they are declared.

   Implementation details:
   * These hooks use the logger from the session, instead of cust

   .. py:method:: set_path_and_pythonpath(sess: BaseSession) -> None
      :staticmethod:

      Configure the Path to expose the Lib targets.


   .. py:method:: set_settings(sess: BaseSession) -> None
      :staticmethod:

      Parse the settings file from the conf/ folder and add the settings to the base statisfactory settings


   .. py:method:: set_catalog(sess: BaseSession) -> None
      :staticmethod:

      Attach the catalog to the session


   .. py:method:: set_parameters(sess: BaseSession) -> None
      :staticmethod:

      Parse and attach pipelines configurations to the Session


   .. py:method:: set_pipelines_definitions(sess: BaseSession) -> None
      :staticmethod:

      Parse and attach pipelines to the Session


   .. py:method:: set_AWS_client(sess: BaseSession) -> None
      :staticmethod:

      Configure a Mamazon session.

      Args:
          sess (Session): The statisfactory session


   .. py:method:: set_git_repo(sess: BaseSession) -> None
      :staticmethod:

      Configure the Git client.

      Args:
          sess (Session): The statisfactory session updated by the hook


   .. py:method:: set_lakefs_client(sess: BaseSession) -> None
      :staticmethod:

      Configure a lakefs client.

      Args:
          sess (Session): The statisfactory session updated by the hook



